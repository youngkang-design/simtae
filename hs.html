<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
     <!-- Google tag (gtag.js) -->
     <script async src="https://www.googletagmanager.com/gtag/js?id=G-37R86615DZ"></script>
     <script>
       window.dataLayer = window.dataLayer || [];
       function gtag(){dataLayer.push(arguments);}
       gtag('js', new Date());
 
       gtag('config', 'G-37R86615DZ');
     </script>

    <title>하트시그널 유형 테스트</title>

    <style>
    @font-face {
        font-family: NEXON Lv2 Gothic;
        src: url("https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_20-04@2.1/NEXON Lv2 Gothic.woff")
          format("woff");
        font-weight: 400;
        font-style: normal;
        font-display: swap;
      }

      body {
        font-family: "NEXON Lv2 Gothic", sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        margin: 0;
        padding: 0;
        text-align: center;
      }

      #mainTitle {
        font-size: 40px;
        font-weight: bold;
      }

      #subTitle {
        font-size: 25px;
        margin-bottom: 30px;
      }

      #countdown {
        margin-bottom: 10px;
        font-size: 20px;
        color: red;
      }

      #notice {
        font-size: 10px;
        margin-top: 20px;
        width: 80%;
      }

      #continueButton {
        display: inline-block;
        padding: 10px 20px;
        font-size: 20px;
        cursor: pointer;
        text-align: center;
        text-decoration: none;
        outline: none;
        color: #fff;
        background-color: #FE8CAC;
        border: none;
        border-radius: 15px;
        box-shadow: 0 9px #999;
      }

      #continueButton:hover {
        background-color: #f74f78;
      }
      #continueButton:active {
        background-color: #f74f78;
        box-shadow: 0 5px #666;
        transform: translateY(4px);
      }

      @media screen and (max-width: 600px) {
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            padding: 0;
            text-align: center;
        }

        #mainTitle {
            font-size: 30px;
            font-weight: bold;
        }

        #subTitle {
            font-size: 20px;
            margin-bottom: 20px;
        }

        #countdown {
            margin-bottom: 10px;
            font-size: 14px;
            color: #868686;
        }

        #notice {
            font-size: 8px;
            margin-top: 20px;
            width: 80%;
        }

        #continueButton {
            display: inline-block;
            padding: 10px 20px;
            font-size: 18px;
            cursor: pointer;
            text-align: center;
            text-decoration: none;
            outline: none;
            color: #fff;
            background-color: #4caf50;
            border: none;
            border-radius: 15px;
            box-shadow: 0 9px #999;
        }
        }

    </style>
  </head>
  <body>
    <h1 id="mainTitle">하트시그널 유형 테스트</h1>
    <h2 id="subTitle">나는 하트시그널에서 누구일까?</h2>
    <p>콘텐츠 보기 전에 쿠팡 쇼핑 어때요?</p>
    <a id="continueButton" href="#">버튼 누르고 결과 보기</a>
    <p id="countdown">원치 않으시면 <span>5</span>를 클릭하세요</p>
    <p id="notice">
      * 이 포스팅은 쿠팡 파트너스 활동의 일환으로 이에 따른 일정액의 수수료를
      제공받습니다.
    </p>

    <script>
      (() => {
        const params = new URLSearchParams(window.location.search);
        const resultUrl = `https://youngkang-design.github.io/simtae/hs-${params.get("type")}${
          window.location.search
        }`;
        const adUrl = "https://link.coupang.com/a/1WIJj";
        const continueButton = document.querySelector("#continueButton");
        const countdownElement = document.querySelector("#countdown");
        const countdownSpan = countdownElement.querySelector("span");
        let countdown = 5;

        const LAST_VISIT_TIMESTAMP_KEY = 'lastVisitTimestamp';
        const TWO_HOURS_IN_MILLISECONDS = 2 * 60 * 60 * 1000;
        const BUTTON_CLICKED_KEY = 'buttonClicked';

        function handleButtonClick() {
          localStorage.setItem(LAST_VISIT_TIMESTAMP_KEY, Date.now().toString());
          localStorage.setItem(BUTTON_CLICKED_KEY, 'true');
        }

        window.onload = function () {
          continueButton.href = resultUrl;

          const lastVisitTimestamp = localStorage.getItem(LAST_VISIT_TIMESTAMP_KEY);
          const buttonClicked = localStorage.getItem(BUTTON_CLICKED_KEY);
          if (buttonClicked === 'true' && lastVisitTimestamp && Date.now() - parseInt(lastVisitTimestamp, 10) < TWO_HOURS_IN_MILLISECONDS) {
            window.location.href = resultUrl;
          } else {
            const countdownInterval = setInterval(() => {
              if (countdown > 0) {
                countdownSpan.innerText = countdown;
                countdown--;
              } else {
                clearInterval(countdownInterval);
                countdownSpan.innerHTML = `<a href="${resultUrl}">X</a>`;
              }
            }, 1000);
            continueButton.addEventListener("click", function () {
              window.open(adUrl);
              handleButtonClick();
            });
            countdownElement.addEventListener("click", function () {
              if (countdown === 0) {
                handleButtonClick();
              }
            });
          }
        };
      })();
    </script>
  </body>
</html>
